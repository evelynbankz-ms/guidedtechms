<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Admin — Support Tickets</title>

<link rel="shortcut icon" href="../asset/logo-icon.png">
<link rel="stylesheet" href="admin.css">

<!-- Quill CSS -->
<link
  href="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.snow.css"
  rel="stylesheet"
/>
</head>

<body>
<div class="admin-wrap">

  <!-- TOP BAR -->
  <header class="admin-topbar">
    <div class="brand">
      <div class="logo">G</div>
      Guided Tech Admin
    </div>
  </header>

  <div class="admin-grid">

    <!-- SIDEBAR -->
    <aside class="admin-side">
      <nav class="side-nav">
        <a href="dashboard.html">Dashboard</a>
        <a href="blog.html">Blog Posts</a>
        <a href="team.html">Team Members</a>
        <a href="faq.html">FAQs</a>
        <a href="testimonials.html">Testimonials</a>
        <a href="careers.html">Careers</a>
        <a href="tickets.html" class="active">Tickets</a>
      </nav>
    </aside>

    <!-- MAIN -->
    <main class="admin-main">

      <!-- ANALYTICS -->
      <div class="stats-grid">
        <div class="stat-card"><h4>Total</h4><span id="statTotal">0</span></div>
        <div class="stat-card"><h4>Open</h4><span id="statOpen">0</span></div>
        <div class="stat-card"><h4>Pending</h4><span id="statPending">0</span></div>
        <div class="stat-card"><h4>Closed</h4><span id="statClosed">0</span></div>
      </div>

      <!-- FILTERS -->
      <div class="filters">
        <select id="statusFilter">
          <option value="">All Status</option>
          <option value="open">Open</option>
          <option value="pending">Pending</option>
          <option value="closed">Closed</option>
        </select>
      </div>

      <div class="tickets-layout">

        <!-- TICKET LIST -->
        <div class="ticket-list" id="ticketList"></div>

        <!-- TICKET DETAIL -->
        <div class="ticket-detail" id="ticketDetail">

          <!-- EMPTY STATE -->
          <div class="empty" id="ticketEmpty">
            Select a ticket to view
          </div>

          <!-- HEADER -->
          <div id="ticketHeader" style="display:none">
            <h3 id="ticketSubject"></h3>
            <p id="ticketMeta"></p>

            <label>Status</label>
            <select id="ticketStatus">
              <option value="open">Open</option>
              <option value="pending">Pending</option>
              <option value="closed">Closed</option>
            </select>
          </div>

          <!-- THREAD -->
          <div id="ticketThread" class="ticket-thread" style="display:none"></div>

          <!-- ADMIN REPLY -->
          <div id="ticketReplyBox" style="display:none; margin-top:16px">

            <label style="margin-bottom:6px;display:block">
              Reply to customer
            </label>

            <!-- Quill editor -->
            <div
              id="ticketReplyEditor"
              style="height:160px;background:#fff;border-radius:8px"
            ></div>

            <div class="row" style="margin-top:12px">
              <button class="btn btn-primary" id="sendReplyBtn">
                Send Reply
              </button>

              <button class="btn btn-ghost" id="closeTicketBtn">
                Close Ticket
              </button>
            </div>

          </div>

        </div>

      </div>

    </main>
  </div>
</div>

<!-- CORE -->
<script type="module" src="firebase.js"></script>
<script type="module" src="tickets.js"></script>

<!-- Quill JS -->
<script src="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.min.js"></script>

<script>
/* ----------------------------------------------------
   QUILL (TICKETS ONLY)
---------------------------------------------------- */

let ticketQuill = null;

window.initTicketQuill = function () {
  const el = document.getElementById("ticketReplyEditor");
  if (!el || typeof Quill === "undefined") return;

  if (ticketQuill) {
    ticketQuill.setContents([]);
    return;
  }

  ticketQuill = new Quill(el, {
    theme: "snow",
    placeholder: "Write your response…",
    modules: {
      toolbar: [
        ["bold", "italic", "underline"],
        [{ list: "ordered" }, { list: "bullet" }],
        ["link"],
        ["clean"]
      ]
    }
  });
};

window.getTicketReplyHTML = function () {
  return ticketQuill ? ticketQuill.root.innerHTML : "";
};

window.clearTicketReply = function () {
  if (ticketQuill) ticketQuill.setContents([]);
};
</script>

</body>
</html>
